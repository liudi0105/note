---
author: liudi
createTime: 2020-01-13
updateTime: 2020-01-13
---

# Redis

## 什么是 Redis？简述它的优缺点

Redis 本质上是一个 key-value 类型的内存数据库，很像 memcached，整个数据库统统加载在内存当中进行操作，定期通过异步操作把数据库数据持久化到硬盘上进行保存。

因为是纯内存操作，Redis 的性能非常出色，每秒可以处理超过 10 万次读写操作，Redis 是已知性能最快的 key-value 数据库。

Redis 的出色之处不仅仅是性能，Redis 最大的魅力是支持保存多种数据结构，此外单个 value 的最大限制是 1GB，不像 memcached 只能保存 1M 的数据，因此 Redis 可以用来实现很多有用的功能。

比方说用他的 List 来做 FIFO 双向链表，实现一个轻量级的高性能消息队列服务，用他的 Set 可以做高性能的 tag 系统等等。

另外 Redis 也可以对存入的键值对设置过期时间，因此也可以被当作一个功能加强版的 memcached 来用。

Redis 的主要缺点是数据库容量受到物理内存的限制，不能用途海量数据的高性能读写，因此 Redis 适合的场景主要局限在较小数据量的高性能操作和运算上。

## Redis 相比 memcached 有哪些优势？

1. memcached 所有的值均是简单的字符串，Redis 作为其替代者，支持更为丰富的数据类型。
2. Redis 的速度比 memcached 快很多。
3. Redis 可以持久化其数据

## Redis 支持哪几种数据类型？

String、List、Set、Sorted Set、Hashes

## Redis 的全称是什么？

Remote Dictionary Server

## Redis 有哪几种数据淘汰策略？

// TODO:

## 一个字符串类型的值能存储最大容量是多少？

512M

## 为什么 Redis 需要把所有数据放到内存中？

Redis 为了达到最快的读写速度将数据都读到内存中，并通过异步的方式将数据写入磁盘。

所以 Redis 具有快速和数据持久化的特征。如果不将数据放在内存中，磁盘 I/O 速度会严重影响 Redis 的性能。

在内存越来越便宜的今天，Redis 将会越来越受欢迎。如果设置了最大使用内存，则数据已有记录数达到内存限值后不能继续插入新值。

## Redis 集群方案应该怎么做？有哪些方案？

1. codis，目前用的最多的集群方案，基本和 twemproxy 一致的效果，但它支持在 节点数量改变情况下，旧节点数据可恢复到新 hash 节点。

2. redis cluster3.0 自带的集群，特点在于他的分布式算法不是一致性 hash，而是 hash 槽的概念，以及自身支持节点设置从节点。具体看官方文档介绍。

3. 在业务代码层实现，起几个毫无关联的 redis 实例，在代码层，对 key 进行 hash 计算，然后去对应的 redis 实例操作数据。 这种方式对 hash 层代码要求比较高，考虑部分包括，节点失效后的替代算法方案，数据震荡后的自动脚本恢复，实例的监控，等等。

## Redis 集群方案什么情况下会导致整个集群不可用？

有 A，B，C 三个节点的集群，在没有复制模型的情况下，如果节点 B 失败，那么整个集群应付以为缺少 5501 - 11000 这个范围的槽而不可用。

## MySQL 里有 2000w 数据，Redis 中只存 20w 的数据，如何保证 Redis 中的数据都是热点数据？

Redis 内存数据集大小上升到一定大小的时候，就会施行数据淘汰策略。

## Redis 有哪些适合的场景？

1. 会话缓存

2. 全页缓存（FPC）

3. 队列

4. 排行榜/计数器

5. 发布/订阅

## Redis 支持的 Java 客户端都有哪些？官方推荐用哪个？

Redisson、Jedis、lettuce 等等，官方推荐使用 Redisson。

## Redis 和 Redisson 有什么关系？

Redisson 是一个高级的分布式协调 Redis 客服端，能帮助用户在分布式环境中轻松实现一些 Java 的对象。

## Redis 如何设置密码及验证密码？

设置密码：config set requirepass 123456

授权密码：auth 123456

## 说说 Redis 哗然槽的概念

Redis 集群没有使用一致性 hash，而是引入了哈希槽的概念，Redis 集群有 16384 个哗然槽，每个 key 通过 CRC16 校验后对 16384 取模来决定放置哪个槽，集群的每个节点负责一部分 hash 槽。

## Redis 集群的主从复制模型是怎样的？

为了使在部分节点失败或者大部分节点无法通信的情况下集群仍然可用，所以集群使用了主从复制模型，筱节点都会有 N - 1 个复制品。

## Redis 集群会有写操作丢失吗？为什么？

Redis 并不能保证数据的强一致性，这意味着在实际使用时集群在特定的条件下可能会丢失写操作。

## Redis 中的管道有什么用？

一次请求/响应服务器能实现处理新的请求即使旧的请求还未被响应。这样就可以将多个命令发送到服务器，而不用等待回复，最后在一个步骤中读取该答复。

这就是管道（pipelining），是一种几十年来广泛使用的技术。例如许多 POP3 协议已经实现支持这个功能，大大加快了从服务器下载新邮件的过程。

## 怎么理解 Redis 事务？

事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。

事务是一个原子操作：事务中的命令要么全部被 执行，要么全部都不执行。

## Redis 事务相关的命令有哪几个？

MULTI、EXEC、DISCARD、WATCH

## Redis key 的过期时间和永久有效分别怎么设置？

EXPIRE 和 PERSIST 命令。

## Redis 如何做内存优化？

尽可能 使用散列表（hashes），散列表（是说散列表里面存储的数少）使用的内存非常小，所以你应该尽可能 地将你的数据模型抽象到一个散列表里面。

比如你的 web 系统中有一个用户对象，不要为这个用户的名称，姓氏，邮箱、密码设置单独的 key，而是应该把这个用户的所有信息存储到一张散列表里面。

## Redis 回收进程如何工作的？

一个客户端运行了新的命令，添加了新的数据。

Redis 检查内存使用情况，如果大于 maxmemory 的限制，则根据设定好的策略进行回收。

## 